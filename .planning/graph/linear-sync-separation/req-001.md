---
id: req-001
title: "Refactor syncGraphProjectDone to syncGraphProjectReview"
dependsOn: []
files:
  creates: []
  modifies:
    - src/linear/sync.ts
    - src/linear/client.ts
    - src/runner/loop.ts
    - tests/linear/linear.test.ts
    - tests/runner/graph-loop.test.ts
acceptance:
  - "syncGraphProjectDone is renamed to syncGraphProjectReview throughout the codebase"
  - "syncGraphProjectReview does NOT batch-transition issues — the updateIssueBatch call is removed entirely"
  - "syncGraphProjectReview transitions the project to 'In Review' using category 'started' with nameHint 'In Review'"
  - "categoryToName in client.ts includes an 'inReview' entry mapping to 'In Review' with a comment noting it shares the 'started' category with 'In Progress'"
  - "All existing tests pass and new tests verify the renamed function transitions project only (not issues)"
---

## Context

Forge currently calls `syncGraphProjectDone` at graph completion, which batch-transitions all issues to "Done" and moves the project to "Completed". This preempts Linear's GitHub automation — issues jump straight to Done before the PR is even reviewed, so the "In Review" state never appears.

The fix: rename the function to `syncGraphProjectReview`, remove the issue batch-update, and change the project transition from `completed` to `started` with nameHint `"In Review"`. In Linear's data model, "In Review" shares the `started` category with "In Progress" — the nameHint disambiguates.

## Technical Approach

### sync.ts changes

1. Rename `syncGraphProjectDone` to `syncGraphProjectReview`
2. Remove the entire `allIssueIds` collection loop and `updateIssueBatch` call
3. Change `transitionProject` call from `("completed", "Done")` to `("started", "In Review")`
4. Update `SyncResult` — the `issuesTransitioned` and `issuesFailed` fields will always be 0/empty since we no longer touch issues, but keep the interface stable for now
5. Update JSDoc to reflect new behavior

### client.ts changes

Add to the `categoryToName` mapping:
```typescript
// "In Review" shares the "started" category with "In Progress" —
// disambiguated by nameHint in resolveIssueStateByCategory/resolveProjectStatusByCategory
inReview: "In Review",
```

Note: The `categoryToName` function maps category strings to display names. "inReview" is not a real Linear category (Linear uses "started" for both "In Progress" and "In Review"), but this entry serves as documentation and fallback for name-based lookups.

### loop.ts changes

Update the import and call site:
- Change `syncGraphProjectDone` to `syncGraphProjectReview` in the import statement
- Change the function call at the end of `runGraphLoop`

### Test changes

- `tests/linear/linear.test.ts`: No sync tests exist here currently (only client tests). No changes needed unless sync tests are added.
- `tests/runner/graph-loop.test.ts`: Update the mock for `syncGraphProjectDone` to `syncGraphProjectReview` in the `vi.mock("../../src/linear/sync.js")` block.

## Interview Notes

- User confirmed project -> Done transition is entirely out of scope — removed, no automated path to Done
- "In Review" is the terminal state Forge sets; Linear/GitHub automation handles the rest
- The SyncResult interface stays stable even though issue fields will be unused — avoid breaking downstream consumers
